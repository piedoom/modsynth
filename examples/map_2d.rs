#![allow(incomplete_features)]
#![feature(generic_const_exprs)]

use modsynth::{Grid2, Synthesizer2};

fn main() {
    let sample = Grid2::new_with_data(
        [10, 16],
        vec![
            "ğŸŸ©", "ğŸŸ©", "â", "â", "â", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸ©", "â", "ğŸŸ¦", "ğŸŸ¦", "ğŸŸ¦", "â", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸ©", "â", "ğŸŸ¦", "ğŸŸ¦", "ğŸŸ¦", "â", "ğŸ ", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸ©", "â", "ğŸŸ¦", "ğŸŸ¦", "â", "ğŸŸ©", "ğŸŸ¨", "ğŸŸ¨", "ğŸŸ©", "ğŸŸª", //
            "ğŸŸ©", "â", "ğŸŸ¦", "ğŸŸ¦", "â", "ğŸŸ¨", "ğŸŸ¨", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸ©", "â", "ğŸŸ¦", "ğŸŸ¦", "â", "ğŸŸ¨", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸ©", "â", "ğŸŸ¦", "ğŸŸ¦", "â", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸ©", "â", "ğŸŸ¦", "ğŸŸ¦", "ğŸŸ¦", "â", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸª", "â", "ğŸŸ«", "ğŸŸ«", "ğŸŸ«", "â", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸ©", "â", "ğŸŸ«", "ğŸŸ«", "ğŸŸ«", "â", "ğŸŸ©", "â", "â", "ğŸŸ©", //
            "ğŸŸ©", "â", "ğŸŸ¦", "ğŸŸ¦", "ğŸŸ¦", "â", "â", "ğŸŸ¦", "ğŸŸ¦", "â", //
            "ğŸŸ©", "â", "ğŸŸ¦", "ğŸŸ¦", "ğŸŸ¦", "â", "ğŸŸ¦", "ğŸŸ¦", "ğŸŸ¦", "â", //
            "ğŸŸ©", "â", "ğŸŸ¦", "ğŸŸ¦", "ğŸŸ¦", "ğŸŸ¦", "ğŸŸ¦", "ğŸŸ¦", "â", "ğŸŸ©", //
            "ğŸŸ©", "â", "ğŸŸ¦", "ğŸŸ¦", "ğŸŸ¦", "ğŸŸ¦", "ğŸŸ¦", "â", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸ©", "â", "ğŸŸ¦", "ğŸŸ¦", "ğŸŸ¦", "â", "â", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸ©", "ğŸŸ©", "â", "â", "â", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸª", "ğŸŸ©", //
        ]
        .chunks(10)
        .rev()
        .flatten()
        .cloned()
        .collect(),
    );

    let sample_2 = Grid2::new_with_data(
        [10, 16],
        vec![
            "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "â¬œ", "â¬œ", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "â¬œ", "â¬œ", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "â¬œ", "â¬œ", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "â¬œ", "â¬œ", "ğŸŸ©", //
            "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "â¬œ", "â¬œ", //
            "ğŸŸ§", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "â¬œ", //
            "ğŸŸ§", "ğŸŸ§", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", //
            "ğŸŸ¨", "ğŸŸ§", "ğŸŸ§", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "â¬œ", //
            "ğŸŸ¨", "ğŸŸ§", "ğŸŸ§", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "â¬œ", "â¬œ", //
            "ğŸŸ§", "ğŸŸ§", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "â¬œ", "â¬œ", "ğŸŸ©", //
            "ğŸŸ§", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "â¬œ", "â¬œ", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "â¬œ", "â¬œ", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸª", "ğŸŸª", "ğŸŸª", "ğŸŸª", "â¬œ", "â¬œ", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸª", "ğŸŸª", "ğŸŸª", "â¬œ", "â¬œ", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
            "ğŸŸª", "ğŸŸª", "ğŸšƒ", "ğŸšƒ", "ğŸšƒ", "ğŸšƒ", "ğŸšƒ", "ğŸšƒ", "ğŸšƒ", "ğŸŸ©", //
            "ğŸŸª", "â¬œ", "â¬œ", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", "ğŸŸ©", //
        ]
        .chunks(10)
        .rev()
        .flatten()
        .cloned()
        .collect(),
    );

    let mut synth = Synthesizer2::from_sample(sample);
    synth.add_sample(sample_2);

    println!("Generated:");

    // synth.synthesize(10, 10, 10000).unwrap().pretty_print();
    // synth.synthesize(7, 7, 10000).unwrap().pretty_print();
    // synth.synthesize(7, 7, 1000).unwrap().pretty_print();
    let grid = synth.synthesize(16, 16, 100000, 16).unwrap();
    // dbg!(info);
    println!("{}", grid.to_string_from_cell(|t| t.to_string()));
}
